I"><h1 id="æ•°æ®æ¥æº"><a href="https://www.kaggle.com/c/titanic">æ•°æ®æ¥æº</a></h1>
<p>layout: post
title: æ³°å¦å°¼å…‹å·ç”Ÿå­˜é¢„æµ‹
subtitle: 
author: Balbo Cheng
categories: python
tags: [pandas, matplotlib, sklearn]
sidebar: []
â€”</p>

<p>æ•°æ®æ¥æºï¼šhttps://www.kaggle.com/c/titanic</p>
<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <p>e5c77ca (æ–°é¡µé¢)</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""
1. è·å–æ•°æ®é›†
2. æ•°æ®åŸºæœ¬å¤„ç†
3. ç‰¹å¾å·¥ç¨‹
4. æœºå™¨å­¦ä¹ 
5. æ¨¡å‹è¯„ä¼°
"""</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="kn">import</span> <span class="n">DictVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="n">export_graphviz</span>

<span class="c1"># å¯¼å…¥æ•°æ®
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/train.csv'</span><span class="p">)</span>
<span class="c1"># for column_name in data.columns:
#     print(column_name)
</span>
<span class="c1"># æ•°æ®åŸºæœ¬å¤„ç†
# ç‰¹å¾å€¼ï¼Œç›®æ ‡å€¼
</span><span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="s">'Sex'</span><span class="p">,</span> <span class="s">'Age'</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span>
<span class="c1"># ç¼ºå¤±å€¼
</span><span class="n">x</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># æ•°æ®é›†åˆ’åˆ†
</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="c1"># ç‰¹å¾å·¥ç¨‹
# è½¬æ¢æˆå­—å…¸
</span><span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s">'records'</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s">'records'</span><span class="p">)</span>

<span class="n">transfer</span> <span class="o">=</span> <span class="n">DictVectorizer</span><span class="p">()</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>

<span class="c1"># æœºå™¨å­¦ä¹ 
</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">estimator</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># æ¨¡å‹è¯„ä¼°
</span><span class="n">y_pre</span> <span class="o">=</span> <span class="n">estimator</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">estimator</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"---å†³ç­–æ ‘--"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"é¢„æµ‹å€¼ä¸ºï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">y_pre</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å‡†ç¡®ç‡ä¸ºï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># æ•°æ®å¯è§†åŒ–
</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s">'data/tree.dot'</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="s">'Sex'</span><span class="p">,</span> <span class="s">'Age'</span><span class="p">,</span> <span class="s">'Survived'</span><span class="p">])</span>
</code></pre></div></div>

<p>å°†ç”Ÿæˆçš„.dotæ–‡ä»¶å¤åˆ¶åˆ°<a href="http://webgraphviz.com/">æ•°æ®å¯è§†åŒ–</a>æ‰“å¼€</p>

<h2 id="ä¼˜åŒ–">ä¼˜åŒ–</h2>

<p>ç”±äºç”Ÿæˆçš„äºŒå‰æ ‘å­˜åœ¨æ¬ æ‹Ÿåˆï¼Œæ‰€ä»¥éœ€å¯¹æ•°æ®è¿›ä¸€æ­¥ä¼˜åŒ–</p>

:ET