I"æ2<h2 id="è·å–æ•°æ®é›†">è·å–æ•°æ®é›†</h2>

<ul>
  <li>å°æ•°æ®é›†ï¼šsklearn.datasets.load.*</li>
  <li>å¤§æ•°æ®é›†ï¼šsklearn.datasets.fetch.*</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span><span class="p">,</span> <span class="n">fetch_20newsgroups</span>

<span class="c1"># æ•°æ®é›†æ”¶é›†
# å°æ•°æ®é›†
</span><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="c1"># print(iris)
</span>
<span class="c1"># å¤§æ•°æ®é›†
# data_home ä¿å­˜ä½ç½®
# subset train/text/all
</span><span class="n">groups</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">data_home</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s">'train'</span><span class="p">)</span>
<span class="c1"># print(groups)
</span></code></pre></div></div>

<h2 id="æ•°æ®é›†å±æ€§æè¿°">æ•°æ®é›†å±æ€§æè¿°</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># è¿”å›å€¼æ˜¯ä¸€ä¸ªâ€œå­—å…¸bunchâ€
</span><span class="k">print</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ•°æ®é›†ä¸­ç‰¹å¾å€¼æ˜¯ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ•°æ®é›†ä¸­ç›®æ ‡å€¼æ˜¯ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">iris</span><span class="p">[</span><span class="s">'target'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ•°æ®é›†ä¸­ç‰¹å¾å€¼åå­—æ˜¯ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ•°æ®é›†ä¸­ç›®æ ‡å€¼æ˜¯åå­—ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æ•°æ®é›†æè¿°æ˜¯ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">DESCR</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="c1"># ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ—¶åŠ ä¸Šä¸€ä¸‹ä¸¤è¡Œ
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'font.sans-serif'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'SimHei'</span><span class="p">]</span>  <span class="c1"># æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.unicode_minus'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># è¿™ä¸¤è¡Œéœ€è¦æ‰‹åŠ¨è®¾ç½®
</span>
<span class="n">iris_d</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s">'data'</span><span class="p">],</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">,</span> <span class="s">'sepal width (cm)'</span><span class="p">,</span> <span class="s">'petal length (cm)'</span><span class="p">,</span> <span class="s">'petal width (cm)'</span><span class="p">])</span>
<span class="n">iris_d</span><span class="p">[</span><span class="s">'species'</span><span class="p">]</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span>
<span class="k">print</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s">'target'</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">plot_iris</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">):</span>
    <span class="c1"># hue ç›®æ ‡å€¼æ˜¯ä»€ä¹ˆ
</span>    <span class="c1"># fit_reg æ˜¯å¦è¿›è¡Œçº¿æ€§æ‹Ÿåˆ
</span>    <span class="n">sns</span><span class="p">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">col1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'species'</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">col2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"é¸¢å°¾èŠ±ç§ç±»åˆ†å¸ƒå›¾"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_iris</span><span class="p">(</span><span class="n">iris_d</span><span class="p">,</span> <span class="s">'sepal length (cm)'</span><span class="p">,</span> <span class="s">'sepal width (cm)'</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="æ•°æ®é›†çš„åˆ’åˆ†">æ•°æ®é›†çš„åˆ’åˆ†</h2>

<p>æœºå™¨å­¦ä¹ ä¸€èˆ¬ä¼šæŠŠæ•°æ®é›†åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†</p>

<ul>
  <li>è®­ç»ƒæ•°æ®ï¼šç”¨äºè®­ç»ƒï¼Œæ„å»ºæ¨¡å‹</li>
  <li>æµ‹è¯•æ•°æ®ï¼šåœ¨æ¨¡å‹æ£€éªŒæ—¶ä½¿ç”¨ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹æ˜¯å¦æœ‰æ•ˆ</li>
</ul>

<p>æ•°æ®åˆ’åˆ†æ¯”ä¾‹ä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§ï¼š7ï¼š3ã€8ï¼š2ã€7.5ï¼š2.5</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># x æ•°æ®é›†çš„ç‰¹å¾å€¼
# y æ•°æ®é›†çš„æ ‡ç­¾å€¼
# test_size æµ‹è¯•é›†çš„å¤§å°ï¼Œä¸€èˆ¬ä¸ºfloat
# random_tate éšæœºæ•°ç§å­
# return è®­ç»ƒé›†ç‰¹å¾å€¼ã€æµ‹è¯•é›†ç‰¹å¾å€¼ã€è®­ç»ƒé›†ç›®æ ‡å€¼ã€æµ‹è¯•é›†ç›®æ ‡å€¼
</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"è®­ç»ƒé›†ç‰¹å¾å€¼ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"æµ‹è¯•é›†ç‰¹å¾å€¼ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x_test</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç </h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># è·å–æ•°æ®é›†
</span><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="c1"># æ•°æ®åŸºæœ¬å¤„ç†
# æ•°æ®åˆ†å‰²
</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># ç‰¹å¾å·¥ç¨‹
# å®ä¾‹åŒ–ä¸€ä¸ªè½¬åŒ–å™¨
</span><span class="n">transfer</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1"># è°ƒç”¨fit.transformå‡½æ•°
</span><span class="n">x_train</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>

<span class="c1"># æœºå™¨å­¦ä¹ 
# å®ä¾‹åŒ–ä¸€ä¸ªä¼°è®¡å™¨
</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># æ¨¡å‹è®­ç»ƒ
</span><span class="n">estimator</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># æ¨¡å‹è¯„ä¼°
# è¾“å‡ºé¢„æµ‹å€¼
</span><span class="n">y_pre</span> <span class="o">=</span> <span class="n">estimator</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"é¢„æµ‹å€¼æ˜¯ï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">y_pre</span><span class="p">)</span>
<span class="c1"># print("çœŸå®å€¼æ˜¯ï¼š\n", y_test)
# print("çœŸå®å€¼å’Œé¢„æµ‹å€¼å¯¹æ¯”ï¼š\n", y_test == y_pre)
# è¾“å‡ºå‡†ç¡®ç‡
</span><span class="n">ret</span> <span class="o">=</span> <span class="n">estimator</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"å‡†ç¡®ç‡ä¸ºï¼š</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>

</code></pre></div></div>

:ET