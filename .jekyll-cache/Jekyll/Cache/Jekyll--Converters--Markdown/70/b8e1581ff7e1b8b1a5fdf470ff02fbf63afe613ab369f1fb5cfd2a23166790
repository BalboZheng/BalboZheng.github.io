I"ÆN<p>Â«Â«Â«&lt; HEAD
Â«Â«Â«&lt; HEAD:_posts/2019-09-06-mybatis-pagehelper.md
â€”
layout:     post
title:      â€œMybatis-PageHelperâ€
subtitle:   â€œMybatis-PageHelper ä½¿ç”¨æ–¹æ³•â€
date:       2019-09-06 12:30:11
author:     â€œBalboâ€
header-img: â€œimg/post-bg-2019.jpgâ€
tags:
    - pagehelper
=======
â€”
layout: post
title: Mybatis-PageHelper
subtitle: Mybatis-PageHelper ä½¿ç”¨æ–¹æ³•
author: Balbo Cheng
categories: java
tags: [pagehelper]</p>
<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <h2 id="e5c77ca-æ–°é¡µé¢">e5c77ca (æ–°é¡µé¢)</h2>
              <h2 id="å¼•å…¥åˆ†é¡µæ’ä»¶">å¼•å…¥åˆ†é¡µæ’ä»¶</h2>
              <p>å¼•å…¥åˆ†é¡µæ’ä»¶æœ‰ä¸‹é¢2ç§æ–¹å¼ï¼Œæ¨èä½¿ç”¨ Maven æ–¹å¼ã€‚</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>

<h3 id="å¼•å…¥-jar-åŒ…">å¼•å…¥ Jar åŒ…</h3>
<p>ä½ å¯ä»¥ä»ä¸‹é¢çš„åœ°å€ä¸­ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ jar åŒ…</p>

<p>ç”±äºä½¿ç”¨äº†sql è§£æå·¥å…·ï¼Œä½ è¿˜éœ€è¦ä¸‹è½½ jsqlparser.jar(éœ€è¦å’ŒPageHelper ä¾èµ–çš„ç‰ˆæœ¬ä¸€è‡´) ï¼š</p>

<p>http://repo1.maven.org/maven2/com/github/jsqlparser/jsqlparser/</p>

<h3 id="ä½¿ç”¨-maven">ä½¿ç”¨ Maven</h3>
<p>åœ¨ pom.xml ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>pagehelper<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>æœ€æ–°ç‰ˆæœ¬<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>æœ€æ–°ç‰ˆæœ¬å·å¯ä»¥ä»é¦–é¡µæŸ¥çœ‹ã€‚</p>

<h2 id="é…ç½®æ‹¦æˆªå™¨æ’ä»¶">é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h2>
<p>ç‰¹åˆ«æ³¨æ„ï¼Œæ–°ç‰ˆæ‹¦æˆªå™¨æ˜¯ com.github.pagehelper.PageInterceptorã€‚</p>

<p>com.github.pagehelper.PageHelper ç°åœ¨æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ dialect å®ç°ç±»ï¼Œæ˜¯åˆ†é¡µæ’ä»¶çš„é»˜è®¤å®ç°ç±»ï¼Œæä¾›äº†å’Œä»¥å‰ç›¸åŒçš„ç”¨æ³•ã€‚</p>

<h3 id="åœ¨-mybatis-é…ç½®-xml-ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶">åœ¨ MyBatis é…ç½® xml ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
pluginsåœ¨é…ç½®æ–‡ä»¶ä¸­çš„ä½ç½®å¿…é¡»ç¬¦åˆè¦æ±‚ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œé¡ºåºå¦‚ä¸‹:
properties?, settings?,
typeAliases?, typeHandlers?,
objectFactory?,objectWrapperFactory?,
plugins?,
environments?, databaseIdProvider?, mappers?
--&gt;</span>
<span class="nt">&lt;plugins&gt;</span>
    <span class="c">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span>
    <span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œåé¢ä¼šæœ‰æ‰€æœ‰çš„å‚æ•°ä»‹ç» --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"param1"</span> <span class="na">value=</span><span class="s">"value1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</code></pre></div></div>
<h3 id="åœ¨-spring-é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶">åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"sqlSessionFactory"</span> <span class="na">class=</span><span class="s">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- æ³¨æ„å…¶ä»–é…ç½® --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"plugins"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"properties"</span><span class="nt">&gt;</span>
                    <span class="c">&lt;!--ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œä¸€è¡Œé…ç½®ä¸€ä¸ª --&gt;</span>
                    <span class="nt">&lt;value&gt;</span>
                        params=value1
                    <span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/property&gt;</span>
            <span class="nt">&lt;/bean&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>
<h3 id="åˆ†é¡µæ’ä»¶å‚æ•°ä»‹ç»">åˆ†é¡µæ’ä»¶å‚æ•°ä»‹ç»</h3>

<p>åˆ†é¡µæ’ä»¶æä¾›äº†å¤šä¸ªå¯é€‰å‚æ•°ï¼Œè¿™äº›å‚æ•°ä½¿ç”¨æ—¶ï¼ŒæŒ‰ç…§ä¸Šé¢ä¸¤ç§é…ç½®æ–¹å¼ä¸­çš„ç¤ºä¾‹é…ç½®å³å¯ã€‚</p>

<p>åˆ†é¡µæ’ä»¶å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š
    dialectï¼šé»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨PageHelperæ–¹å¼è¿›è¡Œåˆ†é¡µï¼Œå¦‚æœæƒ³è¦å®ç°è‡ªå·±çš„åˆ†é¡µé€»è¾‘ï¼Œå¯ä»¥å®ç° Dialect(com.github.pagehelper.Dialect) æ¥å£ï¼Œç„¶åé…ç½®è¯¥å±æ€§ä¸ºå®ç°ç±»çš„å…¨é™å®šåç§°ã€‚</p>

<p>ä¸‹é¢å‡ ä¸ªå‚æ•°éƒ½æ˜¯é’ˆå¯¹é»˜è®¤ dialect æƒ…å†µä¸‹çš„å‚æ•°ã€‚ä½¿ç”¨è‡ªå®šä¹‰ dialect å®ç°æ—¶ï¼Œä¸‹é¢çš„å‚æ•°æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</p>

<ol>
  <li>
    <p>helperDialectï¼šåˆ†é¡µæ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰çš„æ•°æ®åº“é“¾æ¥ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„åˆ†é¡µæ–¹å¼ã€‚</p>

    <p>ä½ å¯ä»¥é…ç½®helperDialectå±æ€§æ¥æŒ‡å®šåˆ†é¡µæ’ä»¶ä½¿ç”¨å“ªç§æ–¹è¨€ã€‚é…ç½®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç¼©å†™å€¼ï¼šoracle,mysql,mariadb,sqlite,hsqldb,postgresql,db2,sqlserver,informix,h2,sqlserver2012,derby</p>

    <p><strong>ç‰¹åˆ«æ³¨æ„ï¼š</strong>ä½¿ç”¨ SqlServer2012 æ•°æ®åº“æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸º sqlserver2012ï¼Œå¦åˆ™ä¼šä½¿ç”¨ SqlServer2005 çš„æ–¹å¼è¿›è¡Œåˆ†é¡µã€‚ä½ ä¹Ÿå¯ä»¥å®ç°AbstractHelperDialectï¼Œç„¶åé…ç½®è¯¥å±æ€§ä¸ºå®ç°ç±»çš„å…¨é™å®šåç§°å³å¯ä½¿ç”¨è‡ªå®šä¹‰çš„å®ç°æ–¹æ³•ã€‚</p>
  </li>
  <li>
    <p>offsetAsPageNumï¼šé»˜è®¤å€¼ä¸º falseï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ RowBounds ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚</p>

    <p>å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼Œä¼šå°† RowBounds ä¸­çš„ offset å‚æ•°å½“æˆ pageNum ä½¿ç”¨ï¼Œå¯ä»¥ç”¨é¡µç å’Œé¡µé¢å¤§å°ä¸¤ä¸ªå‚æ•°è¿›è¡Œåˆ†é¡µã€‚</p>
  </li>
  <li>
    <p>rowBoundsWithCountï¼šé»˜è®¤å€¼ä¸ºfalseï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ RowBounds ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚</p>

    <p>å½“è¯¥å‚æ•°è®¾ç½®ä¸ºtrueæ—¶ï¼Œä½¿ç”¨ RowBounds åˆ†é¡µä¼šè¿›è¡Œ count æŸ¥è¯¢ã€‚</p>
  </li>
  <li>
    <p>pageSizeZeroï¼šé»˜è®¤å€¼ä¸º falseï¼Œå½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼Œå¦‚æœ pageSize=0 æˆ–è€… RowBounds.limit = 0 å°±ä¼šæŸ¥è¯¢å‡ºå…¨éƒ¨çš„ç»“æœï¼ˆç›¸å½“äºæ²¡æœ‰æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œä½†æ˜¯è¿”å›ç»“æœä»ç„¶æ˜¯ Page ç±»å‹ï¼‰ã€‚</p>
  </li>
  <li>
    <p>reasonableï¼šåˆ†é¡µåˆç†åŒ–å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼ŒpageNum&lt;=0 æ—¶ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œ pageNum&gt;pagesï¼ˆè¶…è¿‡æ€»æ•°æ—¶ï¼‰ï¼Œä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚é»˜è®¤false æ—¶ï¼Œç›´æ¥æ ¹æ®å‚æ•°è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
  </li>
  <li>
    <p>paramsï¼šä¸ºäº†æ”¯æŒstartPage(Object params)æ–¹æ³•ï¼Œå¢åŠ äº†è¯¥å‚æ•°æ¥é…ç½®å‚æ•°æ˜ å°„ï¼Œç”¨äºä»å¯¹è±¡ä¸­æ ¹æ®å±æ€§åå–å€¼ï¼Œå¯ä»¥é…ç½®pageNum,pageSize,count,pageSizeZero,reasonableï¼Œä¸é…ç½®æ˜ å°„çš„ç”¨é»˜è®¤å€¼ï¼Œ é»˜è®¤å€¼ä¸ºpageNum=pageNum;pageSize=pageSize;count=countSql;reasonable=reasonable;pageSizeZero=pageSizeZeroã€‚</p>
  </li>
  <li>
    <p>supportMethodsArgumentsï¼šæ”¯æŒé€šè¿‡ Mapper æ¥å£å‚æ•°æ¥ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œé»˜è®¤å€¼falseï¼Œåˆ†é¡µæ’ä»¶ä¼šä»æŸ¥è¯¢æ–¹æ³•çš„å‚æ•°å€¼ä¸­ï¼Œè‡ªåŠ¨æ ¹æ®ä¸Šé¢ params é…ç½®çš„å­—æ®µä¸­å–å€¼ï¼ŒæŸ¥æ‰¾åˆ°åˆé€‚çš„å€¼æ—¶å°±ä¼šè‡ªåŠ¨åˆ†é¡µã€‚ ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæµ‹è¯•ä»£ç ä¸­çš„ com.github.pagehelper.test.basic åŒ…ä¸‹çš„ ArgumentsMapTest å’Œ ArgumentsObjTestã€‚</p>
  </li>
  <li>
    <p>autoRuntimeDialectï¼šé»˜è®¤å€¼ä¸º falseã€‚è®¾ç½®ä¸º true æ—¶ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ ¹æ®å¤šæ•°æ®æºè‡ªåŠ¨è¯†åˆ«å¯¹åº”æ–¹è¨€çš„åˆ†é¡µ ï¼ˆä¸æ”¯æŒè‡ªåŠ¨é€‰æ‹©sqlserver2012ï¼Œåªèƒ½ä½¿ç”¨sqlserverï¼‰ï¼Œç”¨æ³•å’Œæ³¨æ„äº‹é¡¹å‚è€ƒä¸‹é¢çš„åœºæ™¯äº”ã€‚</p>
  </li>
  <li>
    <p>closeConnï¼šé»˜è®¤å€¼ä¸º trueã€‚å½“ä½¿ç”¨è¿è¡Œæ—¶åŠ¨æ€æ•°æ®æºæˆ–æ²¡æœ‰è®¾ç½® helperDialect å±æ€§è‡ªåŠ¨è·å–æ•°æ®åº“ç±»å‹æ—¶ï¼Œä¼šè‡ªåŠ¨è·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œ é€šè¿‡è¯¥å±æ€§æ¥è®¾ç½®æ˜¯å¦å…³é—­è·å–çš„è¿™ä¸ªè¿æ¥ï¼Œé»˜è®¤trueå…³é—­ï¼Œè®¾ç½®ä¸º false åï¼Œä¸ä¼šå…³é—­è·å–çš„è¿æ¥ï¼Œè¿™ä¸ªå‚æ•°çš„è®¾ç½®è¦æ ¹æ®è‡ªå·±é€‰æ‹©çš„æ•°æ®æºæ¥å†³å®šã€‚</p>
  </li>
  <li>
    <p>aggregateFunctions(5.1.5+)ï¼šé»˜è®¤ä¸ºæ‰€æœ‰å¸¸è§æ•°æ®åº“çš„èšåˆå‡½æ•°ï¼Œå…è®¸æ‰‹åŠ¨æ·»åŠ èšåˆå‡½æ•°ï¼ˆå½±å“è¡Œæ•°ï¼‰ï¼Œæ‰€æœ‰ä»¥èšåˆå‡½æ•°å¼€å¤´çš„å‡½æ•°ï¼Œåœ¨è¿›è¡Œ count è½¬æ¢æ—¶ï¼Œä¼šå¥—ä¸€å±‚ã€‚å…¶ä»–å‡½æ•°å’Œåˆ—ä¼šè¢«æ›¿æ¢ä¸º count(0)ï¼Œå…¶ä¸­countåˆ—å¯ä»¥è‡ªå·±é…ç½®ã€‚</p>
  </li>
</ol>

<p><strong>é‡è¦æç¤ºï¼š</strong>å½“ offsetAsPageNum=false çš„æ—¶å€™ï¼Œç”±äº PageNum é—®é¢˜ï¼ŒRowBoundsæŸ¥è¯¢çš„æ—¶å€™ reasonable ä¼šå¼ºåˆ¶ä¸º falseã€‚ä½¿ç”¨ PageHelper.startPage æ–¹æ³•ä¸å—å½±å“ã€‚</p>

<h3 id="å¦‚ä½•é€‰æ‹©é…ç½®è¿™äº›å‚æ•°">å¦‚ä½•é€‰æ‹©é…ç½®è¿™äº›å‚æ•°</h3>

<p>å•ç‹¬çœ‹æ¯ä¸ªå‚æ•°çš„è¯´æ˜å¯èƒ½æ˜¯ä¸€ä»¶è®©äººä¸çˆ½çš„äº‹æƒ…ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›å¯èƒ½ä¼šç”¨åˆ°æŸäº›å‚æ•°çš„æƒ…å†µã€‚</p>

<ol>
  <li>
    <p>å¦‚æœä½ ä»ç„¶åœ¨ç”¨ç±»ä¼¼ibatiså¼çš„å‘½åç©ºé—´è°ƒç”¨æ–¹å¼ï¼Œä½ ä¹Ÿè®¸ä¼šç”¨åˆ°rowBoundsWithCountï¼Œåˆ†é¡µæ’ä»¶å¯¹RowBoundsæ”¯æŒå’Œ MyBatis é»˜è®¤çš„æ–¹å¼æ˜¯ä¸€è‡´ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ä¼šè¿›è¡Œ count æŸ¥è¯¢ï¼Œå¦‚æœä½ æƒ³åœ¨åˆ†é¡µæŸ¥è¯¢æ—¶è¿›è¡Œ count æŸ¥è¯¢ï¼Œ ä»¥åŠä½¿ç”¨æ›´å¼ºå¤§çš„ PageInfo ç±»ï¼Œä½ éœ€è¦è®¾ç½®è¯¥å‚æ•°ä¸º trueã€‚</p>

    <p><strong>æ³¨ï¼š</strong> PageRowBounds æƒ³è¦æŸ¥è¯¢æ€»æ•°ä¹Ÿéœ€è¦é…ç½®è¯¥å±æ€§ä¸º trueã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ ä»ç„¶åœ¨ç”¨ç±»ä¼¼ibatiså¼çš„å‘½åç©ºé—´è°ƒç”¨æ–¹å¼ï¼Œä½ è§‰å¾—RowBoundsä¸­çš„ä¸¤ä¸ªå‚æ•°offset,limitä¸å¦‚pageNum,pageSizeå®¹æ˜“ç†è§£ï¼Œä½ å¯ä»¥ä½¿ç”¨offsetAsPageNumå‚æ•°ï¼Œå°†è¯¥å‚æ•°è®¾ç½®ä¸ºtrueåï¼Œoffsetä¼šå½“æˆ pageNum ä½¿ç”¨ï¼Œlimit å’Œ pageSize å«ä¹‰ç›¸åŒã€‚</p>
  </li>
  <li>
    <p>å¦‚æœè§‰å¾—æŸä¸ªåœ°æ–¹ä½¿ç”¨åˆ†é¡µåï¼Œä½ ä»ç„¶æƒ³é€šè¿‡æ§åˆ¶å‚æ•°æŸ¥è¯¢å…¨éƒ¨çš„ç»“æœï¼Œä½ å¯ä»¥é…ç½® pageSizeZero ä¸º trueï¼Œ é…ç½®åï¼Œå½“ pageSize=0 æˆ–è€… RowBounds.limit = 0 å°±ä¼šæŸ¥è¯¢å‡ºå…¨éƒ¨çš„ç»“æœã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ åˆ†é¡µæ’ä»¶ä½¿ç”¨äºç±»ä¼¼åˆ†é¡µæŸ¥çœ‹åˆ—è¡¨å¼çš„æ•°æ®ï¼Œå¦‚æ–°é—»åˆ—è¡¨ï¼Œè½¯ä»¶åˆ—è¡¨ï¼Œ ä½ å¸Œæœ›ç”¨æˆ·è¾“å…¥çš„é¡µæ•°ä¸åœ¨åˆæ³•èŒƒå›´ï¼ˆç¬¬ä¸€é¡µåˆ°æœ€åä¸€é¡µä¹‹å¤–ï¼‰æ—¶èƒ½å¤Ÿæ­£ç¡®çš„å“åº”åˆ°æ­£ç¡®çš„ç»“æœé¡µé¢ï¼Œ é‚£ä¹ˆä½ å¯ä»¥é…ç½® reasonable ä¸º trueï¼Œè¿™æ—¶å¦‚æœ pageNum&lt;=0 ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œå¦‚æœ pageNum&gt;æ€»é¡µæ•° ä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ åœ¨Springä¸­é…ç½®äº†åŠ¨æ€æ•°æ®æºï¼Œå¹¶ä¸”è¿æ¥ä¸åŒç±»å‹çš„æ•°æ®åº“ï¼Œè¿™æ—¶ä½ å¯ä»¥é…ç½® autoRuntimeDialect ä¸º trueï¼Œè¿™æ ·åœ¨ä½¿ç”¨ä¸åŒæ•°æ®æºæ—¶ï¼Œä¼šä½¿ç”¨åŒ¹é…çš„åˆ†é¡µè¿›è¡ŒæŸ¥è¯¢ã€‚</p>

    <p>è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è¿˜éœ€è¦ç‰¹åˆ«æ³¨æ„ closeConn å‚æ•°ï¼Œç”±äºè·å–æ•°æ®æºç±»å‹ä¼šè·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡è¿™ä¸ªå‚æ•°æ¥æ§åˆ¶è·å–è¿æ¥åï¼Œæ˜¯å¦å…³é—­è¯¥è¿æ¥ã€‚</p>

    <p>é»˜è®¤ä¸º trueï¼Œæœ‰äº›æ•°æ®åº“è¿æ¥å…³é—­åå°±æ²¡æ³•è¿›è¡Œåç»­çš„æ•°æ®åº“æ“ä½œã€‚è€Œæœ‰äº›æ•°æ®åº“è¿æ¥ä¸å…³é—­å°±ä¼šå¾ˆå¿«ç”±äºè¿æ¥æ•°ç”¨å®Œè€Œå¯¼è‡´æ•°æ®åº“æ— å“åº”ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„ä½ ä½¿ç”¨çš„æ•°æ®æºæ˜¯å¦éœ€è¦å…³é—­æ•°æ®åº“è¿æ¥ã€‚</p>
  </li>
</ol>

<p>å½“ä¸ä½¿ç”¨åŠ¨æ€æ•°æ®æºè€Œåªæ˜¯è‡ªåŠ¨è·å– helperDialect æ—¶ï¼Œæ•°æ®åº“è¿æ¥åªä¼šè·å–ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒå ç”¨çš„è¿™ä¸€ä¸ªè¿æ¥æ˜¯å¦ä¼šå¯¼è‡´æ•°æ®åº“å‡ºé”™ï¼Œä½†æ˜¯æœ€å¥½ä¹Ÿæ ¹æ®æ•°æ®æºçš„ç‰¹æ€§é€‰æ‹©æ˜¯å¦å…³é—­è¿æ¥ã€‚</p>
<h2 id="å¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨">å¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨</h2>
<p>é˜…è¯»å‰è¯·æ³¨æ„çœ‹<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/Important.md">é‡è¦æç¤º</a></p>

<p>åˆ†é¡µæ’ä»¶æ”¯æŒä»¥ä¸‹å‡ ç§è°ƒç”¨æ–¹å¼ï¼š</p>

<p>ç¬¬ä¸€ç§ï¼ŒRowBoundsæ–¹å¼çš„è°ƒç”¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> 
<span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"x.y.selectIf"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="nc">RowBounds</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span>
</code></pre></div></div>

<p>ç¬¬äºŒç§ï¼ŒMapperæ¥å£æ–¹å¼çš„è°ƒç”¨ï¼Œæ¨èè¿™ç§ä½¿ç”¨æ–¹å¼ã€‚</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬ä¸‰ç§ï¼ŒMapperæ¥å£æ–¹å¼çš„è°ƒç”¨ï¼Œæ¨èè¿™ç§ä½¿ç”¨æ–¹å¼ã€‚</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">offsetPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬å››ç§ï¼Œå‚æ•°æ–¹æ³•è°ƒç”¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å­˜åœ¨ä»¥ä¸‹ Mapper æ¥å£æ–¹æ³•ï¼Œä½ ä¸éœ€è¦åœ¨ xml å¤„ç†åä¸¤ä¸ªå‚æ•°</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CountryMapper</span> <span class="o">{</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"pageNum"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageNum</span><span class="o">,</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"pageSize"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//é…ç½®supportMethodsArguments=true</span>
<span class="c1">//åœ¨ä»£ç ä¸­ç›´æ¥è°ƒç”¨ï¼š</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectByPageNumSize</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬äº”ç§ï¼Œå‚æ•°å¯¹è±¡</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¦‚æœ pageNum å’Œ pageSize å­˜åœ¨äº User å¯¹è±¡ä¸­ï¼Œåªè¦å‚æ•°æœ‰å€¼ï¼Œä¹Ÿä¼šè¢«åˆ†é¡µ</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="c1">//å…¶ä»–fields</span>
    <span class="c1">//ä¸‹é¢ä¸¤ä¸ªå‚æ•°åå’Œ params é…ç½®çš„åå­—ä¸€è‡´</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">pageNum</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">pageSize</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">//å­˜åœ¨ä»¥ä¸‹ Mapper æ¥å£æ–¹æ³•ï¼Œä½ ä¸éœ€è¦åœ¨ xml å¤„ç†åä¸¤ä¸ªå‚æ•°</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CountryMapper</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//å½“ user ä¸­çš„ pageNum!= null &amp;&amp; pageSize!= null æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectByPageNumSize</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬å…­ç§ï¼ŒISelect æ¥å£æ–¹å¼</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//jdk6,7ç”¨æ³•ï¼Œåˆ›å»ºæ¥å£</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPage</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//jdk8 lambdaç”¨æ³•</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPage</span><span class="o">(()</span>
    <span class="o">-&gt;</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">());</span>

<span class="c1">//ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›PageInfoï¼Œæ³¨æ„doSelectPageInfoæ–¹æ³•å’ŒdoSelectPage</span>
<span class="n">pageInfo</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPageInfo</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//å¯¹åº”çš„lambdaç”¨æ³•</span>
<span class="n">pageInfo</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPageInfo</span><span class="o">(()</span> 
    <span class="o">-&gt;</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">());</span>

<span class="c1">//countæŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„countæ•°</span>
<span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">count</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectLike</span><span class="o">(</span><span class="n">country</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//lambda</span>
<span class="n">total</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">count</span><span class="o">(()-&gt;</span><span class="n">countryMapper</span><span class="o">.</span><span class="na">selectLike</span><span class="o">(</span><span class="n">country</span><span class="o">));</span>
</code></pre></div></div>
<p>ä¸‹é¢å¯¹æœ€å¸¸ç”¨çš„æ–¹å¼è¿›è¡Œè¯¦ç»†ä»‹ç»</p>
<h3 id="rowboundsæ–¹å¼çš„è°ƒç”¨">RowBoundsæ–¹å¼çš„è°ƒç”¨</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> 
<span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"x.y.selectIf"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="nc">RowBounds</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span>
</code></pre></div></div>
<p>ä½¿ç”¨è¿™ç§è°ƒç”¨æ–¹å¼æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨RowBoundså‚æ•°è¿›è¡Œåˆ†é¡µï¼Œè¿™ç§æ–¹å¼ä¾µå…¥æ€§æœ€å°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡RowBoundsæ–¹å¼è°ƒç”¨åªæ˜¯ä½¿ç”¨äº†è¿™ä¸ªå‚æ•°ï¼Œå¹¶æ²¡æœ‰å¢åŠ å…¶ä»–ä»»ä½•å†…å®¹ã€‚</p>

<p>åˆ†é¡µæ’ä»¶æ£€æµ‹åˆ°ä½¿ç”¨äº†RowBoundså‚æ•°æ—¶ï¼Œå°±ä¼šå¯¹è¯¥æŸ¥è¯¢è¿›è¡Œç‰©ç†åˆ†é¡µã€‚</p>

<p>å…³äºè¿™ç§æ–¹å¼çš„è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å‚æ•°æ˜¯é’ˆå¯¹ RowBounds çš„ï¼Œä½ å¯ä»¥å‚çœ‹ä¸Šé¢çš„ åœºæ™¯ä¸€ å’Œ åœºæ™¯äºŒ</p>

<p><strong>æ³¨ï¼š</strong>ä¸åªæœ‰å‘½åç©ºé—´æ–¹å¼å¯ä»¥ç”¨RowBoundsï¼Œä½¿ç”¨æ¥å£çš„æ—¶å€™ä¹Ÿå¯ä»¥å¢åŠ RowBoundså‚æ•°</p>

<p>ä¾‹å¦‚ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è¿™ç§æƒ…å†µä¸‹ä¹Ÿä¼šè¿›è¡Œç‰©ç†åˆ†é¡µæŸ¥è¯¢</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectAll</span><span class="o">(</span><span class="nc">RowBounds</span> <span class="n">rowBounds</span><span class="o">);</span>
</code></pre></div></div>
<p><strong>æ³¨æ„ï¼š</strong>ç”±äºé»˜è®¤æƒ…å†µä¸‹çš„RowBoundsæ— æ³•è·å–æŸ¥è¯¢æ€»æ•°ï¼Œåˆ†é¡µæ’ä»¶æä¾›äº†ä¸€ä¸ªç»§æ‰¿è‡ªRowBoundsçš„PageRowBoundsï¼Œè¿™ä¸ªå¯¹è±¡ä¸­å¢åŠ äº† total å±æ€§ï¼Œæ‰§è¡Œåˆ†é¡µæŸ¥è¯¢åï¼Œå¯ä»¥ä»è¯¥å±æ€§å¾—åˆ°æŸ¥è¯¢æ€»æ•°ã€‚</p>
<h3 id="pagehelperstartpage-é™æ€æ–¹æ³•è°ƒç”¨">PageHelper.startPage é™æ€æ–¹æ³•è°ƒç”¨</h3>
<p>é™¤äº† PageHelper.startPage æ–¹æ³•å¤–ï¼Œè¿˜æä¾›äº†ç±»ä¼¼ç”¨æ³•çš„ PageHelper.offsetPage æ–¹æ³•ã€‚</p>

<p>åœ¨ä½ éœ€è¦è¿›è¡Œåˆ†é¡µçš„MyBatisæŸ¥è¯¢æ–¹æ³•å‰è°ƒç”¨PageHelper.startPageé™æ€æ–¹æ³•å³å¯ï¼Œç´§è·Ÿåœ¨è¿™ä¸ªæ–¹æ³•åçš„ç¬¬ä¸€ä¸ªMyBatisæŸ¥è¯¢æ–¹æ³•ä¼šè¢«è¿›è¡Œåˆ†é¡µã€‚</p>

<p>ä¾‹ä¸€ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="c1">//ç´§è·Ÿç€çš„ç¬¬ä¸€ä¸ªselectæ–¹æ³•ä¼šè¢«åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="c1">//åˆ†é¡µæ—¶ï¼Œå®é™…è¿”å›çš„ç»“æœlistç±»å‹æ˜¯Page&lt;E&gt;ï¼Œå¦‚æœæƒ³å–å‡ºåˆ†é¡µä¿¡æ¯ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ä¸ºPage&lt;E&gt;</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="o">((</span><span class="nc">Page</span><span class="o">)</span> <span class="n">list</span><span class="o">).</span><span class="na">getTotal</span><span class="o">());</span>
</code></pre></div></div>
<p>ä¾‹äºŒï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//request: url?pageNum=1&amp;pageSize=10</span>
<span class="c1">//æ”¯æŒ ServletRequest,Map,POJO å¯¹è±¡ï¼Œéœ€è¦é…åˆ params å‚æ•°</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="c1">//ç´§è·Ÿç€çš„ç¬¬ä¸€ä¸ªselectæ–¹æ³•ä¼šè¢«åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="c1">//åé¢çš„ä¸ä¼šè¢«åˆ†é¡µï¼Œé™¤éå†æ¬¡è°ƒç”¨PageHelper.startPage</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="c1">//list1</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="c1">//åˆ†é¡µæ—¶ï¼Œå®é™…è¿”å›çš„ç»“æœlistç±»å‹æ˜¯Page&lt;E&gt;ï¼Œå¦‚æœæƒ³å–å‡ºåˆ†é¡µä¿¡æ¯ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ä¸ºPage&lt;E&gt;ï¼Œ</span>
<span class="c1">//æˆ–è€…ä½¿ç”¨PageInfoç±»ï¼ˆä¸‹é¢çš„ä¾‹å­æœ‰ä»‹ç»ï¼‰</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="o">((</span><span class="nc">Page</span><span class="o">)</span> <span class="n">list</span><span class="o">).</span><span class="na">getTotal</span><span class="o">());</span>
<span class="c1">//list2</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">list2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="n">list2</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</code></pre></div></div>
<p>ä¾‹ä¸‰ï¼Œä½¿ç”¨PageInfoçš„ç”¨æ³•ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
<span class="c1">//ç”¨PageInfoå¯¹ç»“æœè¿›è¡ŒåŒ…è£…</span>
<span class="nc">PageInfo</span> <span class="n">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PageInfo</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="c1">//æµ‹è¯•PageInfoå…¨éƒ¨å±æ€§</span>
<span class="c1">//PageInfoåŒ…å«äº†éå¸¸å…¨é¢çš„åˆ†é¡µå±æ€§</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPageNum</span><span class="o">());</span><span class="n">å½“å‰é¡µç </span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">());</span><span class="n">æ¯é¡µæ•°é‡</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getStartRow</span><span class="o">());</span><span class="n">å¼€å§‹è®°å½•</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getEndRow</span><span class="o">());</span><span class="n">ç»“æŸè®°å½•</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">183</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getTotal</span><span class="o">());</span><span class="n">æ€»è®°å½•æ•°</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">19</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPages</span><span class="o">());</span><span class="n">æ€»é¡µç </span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getFirstPage</span><span class="o">());</span><span class="n">ç¬¬ä¸€é¡µ</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getLastPage</span><span class="o">());</span><span class="n">æœ€åä¸€é¡µ</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isFirstPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isLastPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isHasPreviousPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isHasNextPage</span><span class="o">());</span>
</code></pre></div></div>
<h3 id="ä½¿ç”¨å‚æ•°æ–¹å¼">ä½¿ç”¨å‚æ•°æ–¹å¼</h3>
<p>æƒ³è¦ä½¿ç”¨å‚æ•°æ–¹å¼ï¼Œéœ€è¦é…ç½® supportMethodsArguments å‚æ•°ä¸º trueï¼ŒåŒæ—¶è¦é…ç½® params å‚æ•°ã€‚ ä¾‹å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugins&gt;</span>
<span class="c">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span>
<span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œåé¢ä¼šæœ‰æ‰€æœ‰çš„å‚æ•°ä»‹ç» --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"supportMethodsArguments"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"params"</span> <span class="na">value=</span><span class="s">"pageNum=pageNumKey;pageSize=pageSizeKey;"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</code></pre></div></div>
<p>åœ¨ MyBatis æ–¹æ³•ä¸­ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"pageNumKey"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageNum</span><span class="o">,</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"pageSizeKey"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="o">);</span>
</code></pre></div></div>
<p>å½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç”±äºåŒæ—¶å‘ç°äº† pageNumKey å’Œ pageSizeKey å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«åˆ†é¡µã€‚params æä¾›çš„å‡ ä¸ªå‚æ•°éƒ½å¯ä»¥è¿™æ ·ä½¿ç”¨ã€‚</p>

<p>é™¤äº†ä¸Šé¢è¿™ç§æ–¹å¼å¤–ï¼Œå¦‚æœ User å¯¹è±¡ä¸­åŒ…å«è¿™ä¸¤ä¸ªå‚æ•°å€¼ï¼Œä¹Ÿå¯ä»¥æœ‰ä¸‹é¢çš„æ–¹æ³•ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">);</span>
</code></pre></div></div>
<p>å½“ä» User ä¸­åŒæ—¶å‘ç°äº† pageNumKey å’Œ pageSizeKey å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«åˆ†é¡µã€‚</p>

<p><strong>æ³¨æ„ï¼š</strong>pageNum å’Œ pageSize ä¸¤ä¸ªå±æ€§åŒæ—¶å­˜åœ¨æ‰ä¼šè§¦å‘åˆ†é¡µæ“ä½œï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå…¶ä»–çš„åˆ†é¡µå‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚</p>

<h3 id="pagehelper-å®‰å…¨è°ƒç”¨">PageHelper å®‰å…¨è°ƒç”¨</h3>
<ol>
  <li>
    <p>ä½¿ç”¨ RowBounds å’Œ PageRowBounds å‚æ•°æ–¹å¼æ˜¯æå…¶å®‰å…¨çš„</p>
  </li>
  <li>
    <p>ä½¿ç”¨å‚æ•°æ–¹å¼æ˜¯æå…¶å®‰å…¨çš„</p>
  </li>
  <li>
    <p>ä½¿ç”¨ ISelect æ¥å£è°ƒç”¨æ˜¯æå…¶å®‰å…¨çš„</p>

    <p>ISelect æ¥å£æ–¹å¼é™¤äº†å¯ä»¥ä¿è¯å®‰å…¨å¤–ï¼Œè¿˜ç‰¹åˆ«å®ç°äº†å°†æŸ¥è¯¢è½¬æ¢ä¸ºå•çº¯çš„ count æŸ¥è¯¢æ–¹å¼ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä»»æ„çš„æŸ¥è¯¢æ–¹æ³•ï¼Œå˜æˆä¸€ä¸ª select count(*) çš„æŸ¥è¯¢æ–¹æ³•ã€‚</p>
  </li>
  <li>
    <p>ä»€ä¹ˆæ—¶å€™ä¼šå¯¼è‡´ä¸å®‰å…¨çš„åˆ†é¡µï¼Ÿ</p>

    <p>PageHelper æ–¹æ³•ä½¿ç”¨äº†é™æ€çš„ ThreadLocal å‚æ•°ï¼Œåˆ†é¡µå‚æ•°å’Œçº¿ç¨‹æ˜¯ç»‘å®šçš„ã€‚</p>

    <p>åªè¦ä½ å¯ä»¥ä¿è¯åœ¨ PageHelper æ–¹æ³•è°ƒç”¨åç´§è·Ÿ MyBatis æŸ¥è¯¢æ–¹æ³•ï¼Œè¿™å°±æ˜¯å®‰å…¨çš„ã€‚å› ä¸º PageHelper åœ¨ finally ä»£ç æ®µä¸­è‡ªåŠ¨æ¸…é™¤äº† ThreadLocal å­˜å‚¨çš„å¯¹è±¡ã€‚</p>

    <p>å¦‚æœä»£ç åœ¨è¿›å…¥ Executor å‰å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹ä¸å¯ç”¨ï¼Œè¿™å±äºäººä¸ºçš„ Bugï¼ˆä¾‹å¦‚æ¥å£æ–¹æ³•å’Œ XML ä¸­çš„ä¸åŒ¹é…ï¼Œå¯¼è‡´æ‰¾ä¸åˆ° MappedStatement æ—¶ï¼‰ï¼Œ è¿™ç§æƒ…å†µç”±äºçº¿ç¨‹ä¸å¯ç”¨ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ ThreadLocal å‚æ•°è¢«é”™è¯¯çš„ä½¿ç”¨ã€‚</p>

    <p>ä½†æ˜¯å¦‚æœä½ å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼Œå°±æ˜¯ä¸å®‰å…¨çš„ç”¨æ³•ï¼š</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
 <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
 <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div>    </div>
    <p>è¿™ç§æƒ…å†µä¸‹ç”±äº param1 å­˜åœ¨ null çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ PageHelper ç”Ÿäº§äº†ä¸€ä¸ªåˆ†é¡µå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œè¿™ä¸ªå‚æ•°å°±ä¼šä¸€ç›´ä¿ç•™åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¢«ä½¿ç”¨æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸è¯¥åˆ†é¡µçš„æ–¹æ³•å»æ¶ˆè´¹è¿™ä¸ªåˆ†é¡µå‚æ•°ï¼Œè¿™å°±äº§ç”Ÿäº†è«åå…¶å¦™çš„åˆ†é¡µã€‚</p>
  </li>
</ol>

<p>ä¸Šé¢è¿™ä¸ªä»£ç ï¼Œåº”è¯¥å†™æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>è¿™ç§å†™æ³•å°±èƒ½ä¿è¯å®‰å…¨ã€‚</p>

<p>å¦‚æœä½ å¯¹æ­¤ä¸æ”¾å¿ƒï¼Œä½ å¯ä»¥æ‰‹åŠ¨æ¸…ç† ThreadLocal å­˜å‚¨çš„åˆ†é¡µå‚æ•°ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="k">try</span><span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">clearPage</span><span class="o">();</span>
<span class="o">}</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>è¿™ä¹ˆå†™å¾ˆä¸å¥½çœ‹ï¼Œè€Œä¸”æ²¡æœ‰å¿…è¦ã€‚</p>

<h2 id="spring-boot-é›†æˆç¤ºä¾‹">Spring Boot é›†æˆç¤ºä¾‹</h2>
<p>https://github.com/abel533/MyBatis-Spring-Boot
Â«Â«Â«&lt; HEAD</p>

<h2>=======</h2>
<p>title: Mybatis-PageHelper ä½¿ç”¨æ–¹æ³•
date: 2019-09-06 12:30:11
tags: [â€˜mybatisâ€™, â€˜pagehelperâ€™]
categories: Mybatis
layout:     post
title:      â€œMybatis-PageHelperâ€
subtitle:   â€œMybatis-PageHelper ä½¿ç”¨æ–¹æ³•â€
date:       2019-09-06 12:30:11
author:     â€œBalboâ€
header-img: â€œimg/post-bg-2019.jpgâ€
catalog: true
tags:
    - pagehelper
â€”</p>
<h2 id="å¼•å…¥åˆ†é¡µæ’ä»¶-1">å¼•å…¥åˆ†é¡µæ’ä»¶</h2>
<p>å¼•å…¥åˆ†é¡µæ’ä»¶æœ‰ä¸‹é¢2ç§æ–¹å¼ï¼Œæ¨èä½¿ç”¨ Maven æ–¹å¼ã€‚</p>

<h3 id="å¼•å…¥-jar-åŒ…-1">å¼•å…¥ Jar åŒ…</h3>
<p>ä½ å¯ä»¥ä»ä¸‹é¢çš„åœ°å€ä¸­ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ jar åŒ…</p>

<p>ç”±äºä½¿ç”¨äº†sql è§£æå·¥å…·ï¼Œä½ è¿˜éœ€è¦ä¸‹è½½ jsqlparser.jar(éœ€è¦å’ŒPageHelper ä¾èµ–çš„ç‰ˆæœ¬ä¸€è‡´) ï¼š</p>

<p>http://repo1.maven.org/maven2/com/github/jsqlparser/jsqlparser/</p>

<h3 id="ä½¿ç”¨-maven-1">ä½¿ç”¨ Maven</h3>
<p>åœ¨ pom.xml ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>pagehelper<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>æœ€æ–°ç‰ˆæœ¬<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>æœ€æ–°ç‰ˆæœ¬å·å¯ä»¥ä»é¦–é¡µæŸ¥çœ‹ã€‚</p>

<h2 id="é…ç½®æ‹¦æˆªå™¨æ’ä»¶-1">é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h2>
<p>ç‰¹åˆ«æ³¨æ„ï¼Œæ–°ç‰ˆæ‹¦æˆªå™¨æ˜¯ com.github.pagehelper.PageInterceptorã€‚</p>

<p>com.github.pagehelper.PageHelper ç°åœ¨æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ dialect å®ç°ç±»ï¼Œæ˜¯åˆ†é¡µæ’ä»¶çš„é»˜è®¤å®ç°ç±»ï¼Œæä¾›äº†å’Œä»¥å‰ç›¸åŒçš„ç”¨æ³•ã€‚</p>

<h3 id="åœ¨-mybatis-é…ç½®-xml-ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶-1">åœ¨ MyBatis é…ç½® xml ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
pluginsåœ¨é…ç½®æ–‡ä»¶ä¸­çš„ä½ç½®å¿…é¡»ç¬¦åˆè¦æ±‚ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œé¡ºåºå¦‚ä¸‹:
properties?, settings?,
typeAliases?, typeHandlers?,
objectFactory?,objectWrapperFactory?,
plugins?,
environments?, databaseIdProvider?, mappers?
--&gt;</span>
<span class="nt">&lt;plugins&gt;</span>
    <span class="c">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span>
    <span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œåé¢ä¼šæœ‰æ‰€æœ‰çš„å‚æ•°ä»‹ç» --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"param1"</span> <span class="na">value=</span><span class="s">"value1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</code></pre></div></div>
<h3 id="åœ¨-spring-é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶-1">åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"sqlSessionFactory"</span> <span class="na">class=</span><span class="s">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- æ³¨æ„å…¶ä»–é…ç½® --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"plugins"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"properties"</span><span class="nt">&gt;</span>
                    <span class="c">&lt;!--ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œä¸€è¡Œé…ç½®ä¸€ä¸ª --&gt;</span>
                    <span class="nt">&lt;value&gt;</span>
                        params=value1
                    <span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/property&gt;</span>
            <span class="nt">&lt;/bean&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>
<h3 id="åˆ†é¡µæ’ä»¶å‚æ•°ä»‹ç»-1">åˆ†é¡µæ’ä»¶å‚æ•°ä»‹ç»</h3>

<p>åˆ†é¡µæ’ä»¶æä¾›äº†å¤šä¸ªå¯é€‰å‚æ•°ï¼Œè¿™äº›å‚æ•°ä½¿ç”¨æ—¶ï¼ŒæŒ‰ç…§ä¸Šé¢ä¸¤ç§é…ç½®æ–¹å¼ä¸­çš„ç¤ºä¾‹é…ç½®å³å¯ã€‚</p>

<p>åˆ†é¡µæ’ä»¶å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š
    dialectï¼šé»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨PageHelperæ–¹å¼è¿›è¡Œåˆ†é¡µï¼Œå¦‚æœæƒ³è¦å®ç°è‡ªå·±çš„åˆ†é¡µé€»è¾‘ï¼Œå¯ä»¥å®ç° Dialect(com.github.pagehelper.Dialect) æ¥å£ï¼Œç„¶åé…ç½®è¯¥å±æ€§ä¸ºå®ç°ç±»çš„å…¨é™å®šåç§°ã€‚</p>

<p>ä¸‹é¢å‡ ä¸ªå‚æ•°éƒ½æ˜¯é’ˆå¯¹é»˜è®¤ dialect æƒ…å†µä¸‹çš„å‚æ•°ã€‚ä½¿ç”¨è‡ªå®šä¹‰ dialect å®ç°æ—¶ï¼Œä¸‹é¢çš„å‚æ•°æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</p>

<ol>
  <li>
    <p>helperDialectï¼šåˆ†é¡µæ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰çš„æ•°æ®åº“é“¾æ¥ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„åˆ†é¡µæ–¹å¼ã€‚</p>

    <p>ä½ å¯ä»¥é…ç½®helperDialectå±æ€§æ¥æŒ‡å®šåˆ†é¡µæ’ä»¶ä½¿ç”¨å“ªç§æ–¹è¨€ã€‚é…ç½®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç¼©å†™å€¼ï¼šoracle,mysql,mariadb,sqlite,hsqldb,postgresql,db2,sqlserver,informix,h2,sqlserver2012,derby</p>

    <p><strong>ç‰¹åˆ«æ³¨æ„ï¼š</strong>ä½¿ç”¨ SqlServer2012 æ•°æ®åº“æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸º sqlserver2012ï¼Œå¦åˆ™ä¼šä½¿ç”¨ SqlServer2005 çš„æ–¹å¼è¿›è¡Œåˆ†é¡µã€‚ä½ ä¹Ÿå¯ä»¥å®ç°AbstractHelperDialectï¼Œç„¶åé…ç½®è¯¥å±æ€§ä¸ºå®ç°ç±»çš„å…¨é™å®šåç§°å³å¯ä½¿ç”¨è‡ªå®šä¹‰çš„å®ç°æ–¹æ³•ã€‚</p>
  </li>
  <li>
    <p>offsetAsPageNumï¼šé»˜è®¤å€¼ä¸º falseï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ RowBounds ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚</p>

    <p>å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼Œä¼šå°† RowBounds ä¸­çš„ offset å‚æ•°å½“æˆ pageNum ä½¿ç”¨ï¼Œå¯ä»¥ç”¨é¡µç å’Œé¡µé¢å¤§å°ä¸¤ä¸ªå‚æ•°è¿›è¡Œåˆ†é¡µã€‚</p>
  </li>
  <li>
    <p>rowBoundsWithCountï¼šé»˜è®¤å€¼ä¸ºfalseï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ RowBounds ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚</p>

    <p>å½“è¯¥å‚æ•°è®¾ç½®ä¸ºtrueæ—¶ï¼Œä½¿ç”¨ RowBounds åˆ†é¡µä¼šè¿›è¡Œ count æŸ¥è¯¢ã€‚</p>
  </li>
  <li>
    <p>pageSizeZeroï¼šé»˜è®¤å€¼ä¸º falseï¼Œå½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼Œå¦‚æœ pageSize=0 æˆ–è€… RowBounds.limit = 0 å°±ä¼šæŸ¥è¯¢å‡ºå…¨éƒ¨çš„ç»“æœï¼ˆç›¸å½“äºæ²¡æœ‰æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œä½†æ˜¯è¿”å›ç»“æœä»ç„¶æ˜¯ Page ç±»å‹ï¼‰ã€‚</p>
  </li>
  <li>
    <p>reasonableï¼šåˆ†é¡µåˆç†åŒ–å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼ŒpageNum&lt;=0 æ—¶ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œ pageNum&gt;pagesï¼ˆè¶…è¿‡æ€»æ•°æ—¶ï¼‰ï¼Œä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚é»˜è®¤false æ—¶ï¼Œç›´æ¥æ ¹æ®å‚æ•°è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
  </li>
  <li>
    <p>paramsï¼šä¸ºäº†æ”¯æŒstartPage(Object params)æ–¹æ³•ï¼Œå¢åŠ äº†è¯¥å‚æ•°æ¥é…ç½®å‚æ•°æ˜ å°„ï¼Œç”¨äºä»å¯¹è±¡ä¸­æ ¹æ®å±æ€§åå–å€¼ï¼Œå¯ä»¥é…ç½®pageNum,pageSize,count,pageSizeZero,reasonableï¼Œä¸é…ç½®æ˜ å°„çš„ç”¨é»˜è®¤å€¼ï¼Œ é»˜è®¤å€¼ä¸ºpageNum=pageNum;pageSize=pageSize;count=countSql;reasonable=reasonable;pageSizeZero=pageSizeZeroã€‚</p>
  </li>
  <li>
    <p>supportMethodsArgumentsï¼šæ”¯æŒé€šè¿‡ Mapper æ¥å£å‚æ•°æ¥ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œé»˜è®¤å€¼falseï¼Œåˆ†é¡µæ’ä»¶ä¼šä»æŸ¥è¯¢æ–¹æ³•çš„å‚æ•°å€¼ä¸­ï¼Œè‡ªåŠ¨æ ¹æ®ä¸Šé¢ params é…ç½®çš„å­—æ®µä¸­å–å€¼ï¼ŒæŸ¥æ‰¾åˆ°åˆé€‚çš„å€¼æ—¶å°±ä¼šè‡ªåŠ¨åˆ†é¡µã€‚ ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæµ‹è¯•ä»£ç ä¸­çš„ com.github.pagehelper.test.basic åŒ…ä¸‹çš„ ArgumentsMapTest å’Œ ArgumentsObjTestã€‚</p>
  </li>
  <li>
    <p>autoRuntimeDialectï¼šé»˜è®¤å€¼ä¸º falseã€‚è®¾ç½®ä¸º true æ—¶ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ ¹æ®å¤šæ•°æ®æºè‡ªåŠ¨è¯†åˆ«å¯¹åº”æ–¹è¨€çš„åˆ†é¡µ ï¼ˆä¸æ”¯æŒè‡ªåŠ¨é€‰æ‹©sqlserver2012ï¼Œåªèƒ½ä½¿ç”¨sqlserverï¼‰ï¼Œç”¨æ³•å’Œæ³¨æ„äº‹é¡¹å‚è€ƒä¸‹é¢çš„åœºæ™¯äº”ã€‚</p>
  </li>
  <li>
    <p>closeConnï¼šé»˜è®¤å€¼ä¸º trueã€‚å½“ä½¿ç”¨è¿è¡Œæ—¶åŠ¨æ€æ•°æ®æºæˆ–æ²¡æœ‰è®¾ç½® helperDialect å±æ€§è‡ªåŠ¨è·å–æ•°æ®åº“ç±»å‹æ—¶ï¼Œä¼šè‡ªåŠ¨è·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œ é€šè¿‡è¯¥å±æ€§æ¥è®¾ç½®æ˜¯å¦å…³é—­è·å–çš„è¿™ä¸ªè¿æ¥ï¼Œé»˜è®¤trueå…³é—­ï¼Œè®¾ç½®ä¸º false åï¼Œä¸ä¼šå…³é—­è·å–çš„è¿æ¥ï¼Œè¿™ä¸ªå‚æ•°çš„è®¾ç½®è¦æ ¹æ®è‡ªå·±é€‰æ‹©çš„æ•°æ®æºæ¥å†³å®šã€‚</p>
  </li>
  <li>
    <p>aggregateFunctions(5.1.5+)ï¼šé»˜è®¤ä¸ºæ‰€æœ‰å¸¸è§æ•°æ®åº“çš„èšåˆå‡½æ•°ï¼Œå…è®¸æ‰‹åŠ¨æ·»åŠ èšåˆå‡½æ•°ï¼ˆå½±å“è¡Œæ•°ï¼‰ï¼Œæ‰€æœ‰ä»¥èšåˆå‡½æ•°å¼€å¤´çš„å‡½æ•°ï¼Œåœ¨è¿›è¡Œ count è½¬æ¢æ—¶ï¼Œä¼šå¥—ä¸€å±‚ã€‚å…¶ä»–å‡½æ•°å’Œåˆ—ä¼šè¢«æ›¿æ¢ä¸º count(0)ï¼Œå…¶ä¸­countåˆ—å¯ä»¥è‡ªå·±é…ç½®ã€‚</p>
  </li>
</ol>

<p><strong>é‡è¦æç¤ºï¼š</strong>å½“ offsetAsPageNum=false çš„æ—¶å€™ï¼Œç”±äº PageNum é—®é¢˜ï¼ŒRowBoundsæŸ¥è¯¢çš„æ—¶å€™ reasonable ä¼šå¼ºåˆ¶ä¸º falseã€‚ä½¿ç”¨ PageHelper.startPage æ–¹æ³•ä¸å—å½±å“ã€‚</p>

<h3 id="å¦‚ä½•é€‰æ‹©é…ç½®è¿™äº›å‚æ•°-1">å¦‚ä½•é€‰æ‹©é…ç½®è¿™äº›å‚æ•°</h3>

<p>å•ç‹¬çœ‹æ¯ä¸ªå‚æ•°çš„è¯´æ˜å¯èƒ½æ˜¯ä¸€ä»¶è®©äººä¸çˆ½çš„äº‹æƒ…ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›å¯èƒ½ä¼šç”¨åˆ°æŸäº›å‚æ•°çš„æƒ…å†µã€‚</p>

<ol>
  <li>
    <p>å¦‚æœä½ ä»ç„¶åœ¨ç”¨ç±»ä¼¼ibatiså¼çš„å‘½åç©ºé—´è°ƒç”¨æ–¹å¼ï¼Œä½ ä¹Ÿè®¸ä¼šç”¨åˆ°rowBoundsWithCountï¼Œåˆ†é¡µæ’ä»¶å¯¹RowBoundsæ”¯æŒå’Œ MyBatis é»˜è®¤çš„æ–¹å¼æ˜¯ä¸€è‡´ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ä¼šè¿›è¡Œ count æŸ¥è¯¢ï¼Œå¦‚æœä½ æƒ³åœ¨åˆ†é¡µæŸ¥è¯¢æ—¶è¿›è¡Œ count æŸ¥è¯¢ï¼Œ ä»¥åŠä½¿ç”¨æ›´å¼ºå¤§çš„ PageInfo ç±»ï¼Œä½ éœ€è¦è®¾ç½®è¯¥å‚æ•°ä¸º trueã€‚</p>

    <p><strong>æ³¨ï¼š</strong> PageRowBounds æƒ³è¦æŸ¥è¯¢æ€»æ•°ä¹Ÿéœ€è¦é…ç½®è¯¥å±æ€§ä¸º trueã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ ä»ç„¶åœ¨ç”¨ç±»ä¼¼ibatiså¼çš„å‘½åç©ºé—´è°ƒç”¨æ–¹å¼ï¼Œä½ è§‰å¾—RowBoundsä¸­çš„ä¸¤ä¸ªå‚æ•°offset,limitä¸å¦‚pageNum,pageSizeå®¹æ˜“ç†è§£ï¼Œä½ å¯ä»¥ä½¿ç”¨offsetAsPageNumå‚æ•°ï¼Œå°†è¯¥å‚æ•°è®¾ç½®ä¸ºtrueåï¼Œoffsetä¼šå½“æˆ pageNum ä½¿ç”¨ï¼Œlimit å’Œ pageSize å«ä¹‰ç›¸åŒã€‚</p>
  </li>
  <li>
    <p>å¦‚æœè§‰å¾—æŸä¸ªåœ°æ–¹ä½¿ç”¨åˆ†é¡µåï¼Œä½ ä»ç„¶æƒ³é€šè¿‡æ§åˆ¶å‚æ•°æŸ¥è¯¢å…¨éƒ¨çš„ç»“æœï¼Œä½ å¯ä»¥é…ç½® pageSizeZero ä¸º trueï¼Œ é…ç½®åï¼Œå½“ pageSize=0 æˆ–è€… RowBounds.limit = 0 å°±ä¼šæŸ¥è¯¢å‡ºå…¨éƒ¨çš„ç»“æœã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ åˆ†é¡µæ’ä»¶ä½¿ç”¨äºç±»ä¼¼åˆ†é¡µæŸ¥çœ‹åˆ—è¡¨å¼çš„æ•°æ®ï¼Œå¦‚æ–°é—»åˆ—è¡¨ï¼Œè½¯ä»¶åˆ—è¡¨ï¼Œ ä½ å¸Œæœ›ç”¨æˆ·è¾“å…¥çš„é¡µæ•°ä¸åœ¨åˆæ³•èŒƒå›´ï¼ˆç¬¬ä¸€é¡µåˆ°æœ€åä¸€é¡µä¹‹å¤–ï¼‰æ—¶èƒ½å¤Ÿæ­£ç¡®çš„å“åº”åˆ°æ­£ç¡®çš„ç»“æœé¡µé¢ï¼Œ é‚£ä¹ˆä½ å¯ä»¥é…ç½® reasonable ä¸º trueï¼Œè¿™æ—¶å¦‚æœ pageNum&lt;=0 ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œå¦‚æœ pageNum&gt;æ€»é¡µæ•° ä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚</p>
  </li>
  <li>
    <p>å¦‚æœä½ åœ¨Springä¸­é…ç½®äº†åŠ¨æ€æ•°æ®æºï¼Œå¹¶ä¸”è¿æ¥ä¸åŒç±»å‹çš„æ•°æ®åº“ï¼Œè¿™æ—¶ä½ å¯ä»¥é…ç½® autoRuntimeDialect ä¸º trueï¼Œè¿™æ ·åœ¨ä½¿ç”¨ä¸åŒæ•°æ®æºæ—¶ï¼Œä¼šä½¿ç”¨åŒ¹é…çš„åˆ†é¡µè¿›è¡ŒæŸ¥è¯¢ã€‚</p>

    <p>è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è¿˜éœ€è¦ç‰¹åˆ«æ³¨æ„ closeConn å‚æ•°ï¼Œç”±äºè·å–æ•°æ®æºç±»å‹ä¼šè·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡è¿™ä¸ªå‚æ•°æ¥æ§åˆ¶è·å–è¿æ¥åï¼Œæ˜¯å¦å…³é—­è¯¥è¿æ¥ã€‚</p>

    <p>é»˜è®¤ä¸º trueï¼Œæœ‰äº›æ•°æ®åº“è¿æ¥å…³é—­åå°±æ²¡æ³•è¿›è¡Œåç»­çš„æ•°æ®åº“æ“ä½œã€‚è€Œæœ‰äº›æ•°æ®åº“è¿æ¥ä¸å…³é—­å°±ä¼šå¾ˆå¿«ç”±äºè¿æ¥æ•°ç”¨å®Œè€Œå¯¼è‡´æ•°æ®åº“æ— å“åº”ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œç‰¹åˆ«éœ€è¦æ³¨æ„ä½ ä½¿ç”¨çš„æ•°æ®æºæ˜¯å¦éœ€è¦å…³é—­æ•°æ®åº“è¿æ¥ã€‚</p>
  </li>
</ol>

<p>å½“ä¸ä½¿ç”¨åŠ¨æ€æ•°æ®æºè€Œåªæ˜¯è‡ªåŠ¨è·å– helperDialect æ—¶ï¼Œæ•°æ®åº“è¿æ¥åªä¼šè·å–ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒå ç”¨çš„è¿™ä¸€ä¸ªè¿æ¥æ˜¯å¦ä¼šå¯¼è‡´æ•°æ®åº“å‡ºé”™ï¼Œä½†æ˜¯æœ€å¥½ä¹Ÿæ ¹æ®æ•°æ®æºçš„ç‰¹æ€§é€‰æ‹©æ˜¯å¦å…³é—­è¿æ¥ã€‚</p>
<h2 id="å¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨-1">å¦‚ä½•åœ¨ä»£ç ä¸­ä½¿ç”¨</h2>
<p>é˜…è¯»å‰è¯·æ³¨æ„çœ‹<a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/Important.md">é‡è¦æç¤º</a></p>

<p>åˆ†é¡µæ’ä»¶æ”¯æŒä»¥ä¸‹å‡ ç§è°ƒç”¨æ–¹å¼ï¼š</p>

<p>ç¬¬ä¸€ç§ï¼ŒRowBoundsæ–¹å¼çš„è°ƒç”¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> 
<span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"x.y.selectIf"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="nc">RowBounds</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span>
</code></pre></div></div>

<p>ç¬¬äºŒç§ï¼ŒMapperæ¥å£æ–¹å¼çš„è°ƒç”¨ï¼Œæ¨èè¿™ç§ä½¿ç”¨æ–¹å¼ã€‚</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬ä¸‰ç§ï¼ŒMapperæ¥å£æ–¹å¼çš„è°ƒç”¨ï¼Œæ¨èè¿™ç§ä½¿ç”¨æ–¹å¼ã€‚</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">offsetPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬å››ç§ï¼Œå‚æ•°æ–¹æ³•è°ƒç”¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å­˜åœ¨ä»¥ä¸‹ Mapper æ¥å£æ–¹æ³•ï¼Œä½ ä¸éœ€è¦åœ¨ xml å¤„ç†åä¸¤ä¸ªå‚æ•°</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CountryMapper</span> <span class="o">{</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"pageNum"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageNum</span><span class="o">,</span>
    <span class="nd">@Param</span><span class="o">(</span><span class="s">"pageSize"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//é…ç½®supportMethodsArguments=true</span>
<span class="c1">//åœ¨ä»£ç ä¸­ç›´æ¥è°ƒç”¨ï¼š</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectByPageNumSize</span><span class="o">(</span><span class="n">user</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬äº”ç§ï¼Œå‚æ•°å¯¹è±¡</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¦‚æœ pageNum å’Œ pageSize å­˜åœ¨äº User å¯¹è±¡ä¸­ï¼Œåªè¦å‚æ•°æœ‰å€¼ï¼Œä¹Ÿä¼šè¢«åˆ†é¡µ</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="c1">//å…¶ä»–fields</span>
    <span class="c1">//ä¸‹é¢ä¸¤ä¸ªå‚æ•°åå’Œ params é…ç½®çš„åå­—ä¸€è‡´</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">pageNum</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">pageSize</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">//å­˜åœ¨ä»¥ä¸‹ Mapper æ¥å£æ–¹æ³•ï¼Œä½ ä¸éœ€è¦åœ¨ xml å¤„ç†åä¸¤ä¸ªå‚æ•°</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CountryMapper</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//å½“ user ä¸­çš„ pageNum!= null &amp;&amp; pageSize!= null æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectByPageNumSize</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</code></pre></div></div>

<p>ç¬¬å…­ç§ï¼ŒISelect æ¥å£æ–¹å¼</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//jdk6,7ç”¨æ³•ï¼Œåˆ›å»ºæ¥å£</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPage</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//jdk8 lambdaç”¨æ³•</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPage</span><span class="o">(()</span>
    <span class="o">-&gt;</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">());</span>

<span class="c1">//ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›PageInfoï¼Œæ³¨æ„doSelectPageInfoæ–¹æ³•å’ŒdoSelectPage</span>
<span class="n">pageInfo</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPageInfo</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//å¯¹åº”çš„lambdaç”¨æ³•</span>
<span class="n">pageInfo</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">doSelectPageInfo</span><span class="o">(()</span> 
    <span class="o">-&gt;</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectGroupBy</span><span class="o">());</span>

<span class="c1">//countæŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„countæ•°</span>
<span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">count</span><span class="o">(</span><span class="k">new</span> <span class="nc">ISelect</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSelect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectLike</span><span class="o">(</span><span class="n">country</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//lambda</span>
<span class="n">total</span> <span class="o">=</span> <span class="nc">PageHelper</span><span class="o">.</span><span class="na">count</span><span class="o">(()-&gt;</span><span class="n">countryMapper</span><span class="o">.</span><span class="na">selectLike</span><span class="o">(</span><span class="n">country</span><span class="o">));</span>
</code></pre></div></div>
<p>ä¸‹é¢å¯¹æœ€å¸¸ç”¨çš„æ–¹å¼è¿›è¡Œè¯¦ç»†ä»‹ç»</p>
<h3 id="rowboundsæ–¹å¼çš„è°ƒç”¨-1">RowBoundsæ–¹å¼çš„è°ƒç”¨</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> 
<span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"x.y.selectIf"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="nc">RowBounds</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span>
</code></pre></div></div>
<p>ä½¿ç”¨è¿™ç§è°ƒç”¨æ–¹å¼æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨RowBoundså‚æ•°è¿›è¡Œåˆ†é¡µï¼Œè¿™ç§æ–¹å¼ä¾µå…¥æ€§æœ€å°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡RowBoundsæ–¹å¼è°ƒç”¨åªæ˜¯ä½¿ç”¨äº†è¿™ä¸ªå‚æ•°ï¼Œå¹¶æ²¡æœ‰å¢åŠ å…¶ä»–ä»»ä½•å†…å®¹ã€‚</p>

<p>åˆ†é¡µæ’ä»¶æ£€æµ‹åˆ°ä½¿ç”¨äº†RowBoundså‚æ•°æ—¶ï¼Œå°±ä¼šå¯¹è¯¥æŸ¥è¯¢è¿›è¡Œç‰©ç†åˆ†é¡µã€‚</p>

<p>å…³äºè¿™ç§æ–¹å¼çš„è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å‚æ•°æ˜¯é’ˆå¯¹ RowBounds çš„ï¼Œä½ å¯ä»¥å‚çœ‹ä¸Šé¢çš„ åœºæ™¯ä¸€ å’Œ åœºæ™¯äºŒ</p>

<p><strong>æ³¨ï¼š</strong>ä¸åªæœ‰å‘½åç©ºé—´æ–¹å¼å¯ä»¥ç”¨RowBoundsï¼Œä½¿ç”¨æ¥å£çš„æ—¶å€™ä¹Ÿå¯ä»¥å¢åŠ RowBoundså‚æ•°</p>

<p>ä¾‹å¦‚ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è¿™ç§æƒ…å†µä¸‹ä¹Ÿä¼šè¿›è¡Œç‰©ç†åˆ†é¡µæŸ¥è¯¢</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectAll</span><span class="o">(</span><span class="nc">RowBounds</span> <span class="n">rowBounds</span><span class="o">);</span>
</code></pre></div></div>
<p><strong>æ³¨æ„ï¼š</strong>ç”±äºé»˜è®¤æƒ…å†µä¸‹çš„RowBoundsæ— æ³•è·å–æŸ¥è¯¢æ€»æ•°ï¼Œåˆ†é¡µæ’ä»¶æä¾›äº†ä¸€ä¸ªç»§æ‰¿è‡ªRowBoundsçš„PageRowBoundsï¼Œè¿™ä¸ªå¯¹è±¡ä¸­å¢åŠ äº† total å±æ€§ï¼Œæ‰§è¡Œåˆ†é¡µæŸ¥è¯¢åï¼Œå¯ä»¥ä»è¯¥å±æ€§å¾—åˆ°æŸ¥è¯¢æ€»æ•°ã€‚</p>
<h3 id="pagehelperstartpage-é™æ€æ–¹æ³•è°ƒç”¨-1">PageHelper.startPage é™æ€æ–¹æ³•è°ƒç”¨</h3>
<p>é™¤äº† PageHelper.startPage æ–¹æ³•å¤–ï¼Œè¿˜æä¾›äº†ç±»ä¼¼ç”¨æ³•çš„ PageHelper.offsetPage æ–¹æ³•ã€‚</p>

<p>åœ¨ä½ éœ€è¦è¿›è¡Œåˆ†é¡µçš„MyBatisæŸ¥è¯¢æ–¹æ³•å‰è°ƒç”¨PageHelper.startPageé™æ€æ–¹æ³•å³å¯ï¼Œç´§è·Ÿåœ¨è¿™ä¸ªæ–¹æ³•åçš„ç¬¬ä¸€ä¸ªMyBatisæŸ¥è¯¢æ–¹æ³•ä¼šè¢«è¿›è¡Œåˆ†é¡µã€‚</p>

<p>ä¾‹ä¸€ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="c1">//ç´§è·Ÿç€çš„ç¬¬ä¸€ä¸ªselectæ–¹æ³•ä¼šè¢«åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="c1">//åˆ†é¡µæ—¶ï¼Œå®é™…è¿”å›çš„ç»“æœlistç±»å‹æ˜¯Page&lt;E&gt;ï¼Œå¦‚æœæƒ³å–å‡ºåˆ†é¡µä¿¡æ¯ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ä¸ºPage&lt;E&gt;</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="o">((</span><span class="nc">Page</span><span class="o">)</span> <span class="n">list</span><span class="o">).</span><span class="na">getTotal</span><span class="o">());</span>
</code></pre></div></div>
<p>ä¾‹äºŒï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//request: url?pageNum=1&amp;pageSize=10</span>
<span class="c1">//æ”¯æŒ ServletRequest,Map,POJO å¯¹è±¡ï¼Œéœ€è¦é…åˆ params å‚æ•°</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="c1">//ç´§è·Ÿç€çš„ç¬¬ä¸€ä¸ªselectæ–¹æ³•ä¼šè¢«åˆ†é¡µ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="c1">//åé¢çš„ä¸ä¼šè¢«åˆ†é¡µï¼Œé™¤éå†æ¬¡è°ƒç”¨PageHelper.startPage</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="c1">//list1</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="c1">//åˆ†é¡µæ—¶ï¼Œå®é™…è¿”å›çš„ç»“æœlistç±»å‹æ˜¯Page&lt;E&gt;ï¼Œå¦‚æœæƒ³å–å‡ºåˆ†é¡µä¿¡æ¯ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ä¸ºPage&lt;E&gt;ï¼Œ</span>
<span class="c1">//æˆ–è€…ä½¿ç”¨PageInfoç±»ï¼ˆä¸‹é¢çš„ä¾‹å­æœ‰ä»‹ç»ï¼‰</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="o">((</span><span class="nc">Page</span><span class="o">)</span> <span class="n">list</span><span class="o">).</span><span class="na">getTotal</span><span class="o">());</span>
<span class="c1">//list2</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">list2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getId</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">182</span><span class="o">,</span> <span class="n">list2</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</code></pre></div></div>
<p>ä¾‹ä¸‰ï¼Œä½¿ç”¨PageInfoçš„ç”¨æ³•ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count</span>
<span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
<span class="c1">//ç”¨PageInfoå¯¹ç»“æœè¿›è¡ŒåŒ…è£…</span>
<span class="nc">PageInfo</span> <span class="n">page</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PageInfo</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="c1">//æµ‹è¯•PageInfoå…¨éƒ¨å±æ€§</span>
<span class="c1">//PageInfoåŒ…å«äº†éå¸¸å…¨é¢çš„åˆ†é¡µå±æ€§</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPageNum</span><span class="o">());</span><span class="n">å½“å‰é¡µç </span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">());</span><span class="n">æ¯é¡µæ•°é‡</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getStartRow</span><span class="o">());</span><span class="n">å¼€å§‹è®°å½•</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getEndRow</span><span class="o">());</span><span class="n">ç»“æŸè®°å½•</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">183</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getTotal</span><span class="o">());</span><span class="n">æ€»è®°å½•æ•°</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">19</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getPages</span><span class="o">());</span><span class="n">æ€»é¡µç </span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getFirstPage</span><span class="o">());</span><span class="n">ç¬¬ä¸€é¡µ</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getLastPage</span><span class="o">());</span><span class="n">æœ€åä¸€é¡µ</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isFirstPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isLastPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isHasPreviousPage</span><span class="o">());</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">isHasNextPage</span><span class="o">());</span>
</code></pre></div></div>
<h3 id="ä½¿ç”¨å‚æ•°æ–¹å¼-1">ä½¿ç”¨å‚æ•°æ–¹å¼</h3>
<p>æƒ³è¦ä½¿ç”¨å‚æ•°æ–¹å¼ï¼Œéœ€è¦é…ç½® supportMethodsArguments å‚æ•°ä¸º trueï¼ŒåŒæ—¶è¦é…ç½® params å‚æ•°ã€‚ ä¾‹å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugins&gt;</span>
<span class="c">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span>
<span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">"com.github.pagehelper.PageInterceptor"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œåé¢ä¼šæœ‰æ‰€æœ‰çš„å‚æ•°ä»‹ç» --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"supportMethodsArguments"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"params"</span> <span class="na">value=</span><span class="s">"pageNum=pageNumKey;pageSize=pageSizeKey;"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</code></pre></div></div>
<p>åœ¨ MyBatis æ–¹æ³•ä¸­ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">,</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"pageNumKey"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageNum</span><span class="o">,</span>
<span class="nd">@Param</span><span class="o">(</span><span class="s">"pageSizeKey"</span><span class="o">)</span> <span class="kt">int</span> <span class="n">pageSize</span><span class="o">);</span>
</code></pre></div></div>
<p>å½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç”±äºåŒæ—¶å‘ç°äº† pageNumKey å’Œ pageSizeKey å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«åˆ†é¡µã€‚params æä¾›çš„å‡ ä¸ªå‚æ•°éƒ½å¯ä»¥è¿™æ ·ä½¿ç”¨ã€‚</p>

<p>é™¤äº†ä¸Šé¢è¿™ç§æ–¹å¼å¤–ï¼Œå¦‚æœ User å¯¹è±¡ä¸­åŒ…å«è¿™ä¸¤ä¸ªå‚æ•°å€¼ï¼Œä¹Ÿå¯ä»¥æœ‰ä¸‹é¢çš„æ–¹æ³•ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="nf">selectByPageNumSize</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">);</span>
</code></pre></div></div>
<p>å½“ä» User ä¸­åŒæ—¶å‘ç°äº† pageNumKey å’Œ pageSizeKey å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«åˆ†é¡µã€‚</p>

<p><strong>æ³¨æ„ï¼š</strong>pageNum å’Œ pageSize ä¸¤ä¸ªå±æ€§åŒæ—¶å­˜åœ¨æ‰ä¼šè§¦å‘åˆ†é¡µæ“ä½œï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå…¶ä»–çš„åˆ†é¡µå‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚</p>

<h3 id="pagehelper-å®‰å…¨è°ƒç”¨-1">PageHelper å®‰å…¨è°ƒç”¨</h3>
<ol>
  <li>
    <p>ä½¿ç”¨ RowBounds å’Œ PageRowBounds å‚æ•°æ–¹å¼æ˜¯æå…¶å®‰å…¨çš„</p>
  </li>
  <li>
    <p>ä½¿ç”¨å‚æ•°æ–¹å¼æ˜¯æå…¶å®‰å…¨çš„</p>
  </li>
  <li>
    <p>ä½¿ç”¨ ISelect æ¥å£è°ƒç”¨æ˜¯æå…¶å®‰å…¨çš„</p>

    <p>ISelect æ¥å£æ–¹å¼é™¤äº†å¯ä»¥ä¿è¯å®‰å…¨å¤–ï¼Œè¿˜ç‰¹åˆ«å®ç°äº†å°†æŸ¥è¯¢è½¬æ¢ä¸ºå•çº¯çš„ count æŸ¥è¯¢æ–¹å¼ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä»»æ„çš„æŸ¥è¯¢æ–¹æ³•ï¼Œå˜æˆä¸€ä¸ª select count(*) çš„æŸ¥è¯¢æ–¹æ³•ã€‚</p>
  </li>
  <li>
    <p>ä»€ä¹ˆæ—¶å€™ä¼šå¯¼è‡´ä¸å®‰å…¨çš„åˆ†é¡µï¼Ÿ</p>

    <p>PageHelper æ–¹æ³•ä½¿ç”¨äº†é™æ€çš„ ThreadLocal å‚æ•°ï¼Œåˆ†é¡µå‚æ•°å’Œçº¿ç¨‹æ˜¯ç»‘å®šçš„ã€‚</p>

    <p>åªè¦ä½ å¯ä»¥ä¿è¯åœ¨ PageHelper æ–¹æ³•è°ƒç”¨åç´§è·Ÿ MyBatis æŸ¥è¯¢æ–¹æ³•ï¼Œè¿™å°±æ˜¯å®‰å…¨çš„ã€‚å› ä¸º PageHelper åœ¨ finally ä»£ç æ®µä¸­è‡ªåŠ¨æ¸…é™¤äº† ThreadLocal å­˜å‚¨çš„å¯¹è±¡ã€‚</p>

    <p>å¦‚æœä»£ç åœ¨è¿›å…¥ Executor å‰å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹ä¸å¯ç”¨ï¼Œè¿™å±äºäººä¸ºçš„ Bugï¼ˆä¾‹å¦‚æ¥å£æ–¹æ³•å’Œ XML ä¸­çš„ä¸åŒ¹é…ï¼Œå¯¼è‡´æ‰¾ä¸åˆ° MappedStatement æ—¶ï¼‰ï¼Œ è¿™ç§æƒ…å†µç”±äºçº¿ç¨‹ä¸å¯ç”¨ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ ThreadLocal å‚æ•°è¢«é”™è¯¯çš„ä½¿ç”¨ã€‚</p>

    <p>ä½†æ˜¯å¦‚æœä½ å†™å‡ºä¸‹é¢è¿™æ ·çš„ä»£ç ï¼Œå°±æ˜¯ä¸å®‰å…¨çš„ç”¨æ³•ï¼š</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
 <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
 <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div>    </div>
    <p>è¿™ç§æƒ…å†µä¸‹ç”±äº param1 å­˜åœ¨ null çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ PageHelper ç”Ÿäº§äº†ä¸€ä¸ªåˆ†é¡µå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œè¿™ä¸ªå‚æ•°å°±ä¼šä¸€ç›´ä¿ç•™åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¢«ä½¿ç”¨æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸è¯¥åˆ†é¡µçš„æ–¹æ³•å»æ¶ˆè´¹è¿™ä¸ªåˆ†é¡µå‚æ•°ï¼Œè¿™å°±äº§ç”Ÿäº†è«åå…¶å¦™çš„åˆ†é¡µã€‚</p>
  </li>
</ol>

<p>ä¸Šé¢è¿™ä¸ªä»£ç ï¼Œåº”è¯¥å†™æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectIf</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>è¿™ç§å†™æ³•å°±èƒ½ä¿è¯å®‰å…¨ã€‚</p>

<p>å¦‚æœä½ å¯¹æ­¤ä¸æ”¾å¿ƒï¼Œä½ å¯ä»¥æ‰‹åŠ¨æ¸…ç† ThreadLocal å­˜å‚¨çš„åˆ†é¡µå‚æ•°ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼š</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
<span class="k">if</span><span class="o">(</span><span class="n">param1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="k">try</span><span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="n">countryMapper</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="nc">PageHelper</span><span class="o">.</span><span class="na">clearPage</span><span class="o">();</span>
<span class="o">}</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Country</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>è¿™ä¹ˆå†™å¾ˆä¸å¥½çœ‹ï¼Œè€Œä¸”æ²¡æœ‰å¿…è¦ã€‚</p>

<h2 id="spring-boot-é›†æˆç¤ºä¾‹-1">Spring Boot é›†æˆç¤ºä¾‹</h2>
<p>https://github.com/abel533/MyBatis-Spring-Boot</p>

<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <h1 id="f0bfe13-new-update_postsçŸ¥è¯†ç‚¹2019-09-06-mybatis-pagehelpermd">f0bfe13 (new update):_posts/çŸ¥è¯†ç‚¹/2019-09-06-mybatis-pagehelper.md</h1>
              <p>e5c77ca (æ–°é¡µé¢)</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>
:ET